require(["config"],function(){require(["jquery"],function(o){o(function(){var e=JSON.parse(sessionStorage.getItem("user")||"[]")[0].u_rank,s=0;function d(){o.ajax({url:"http://101.200.60.236:9090/job/count",type:"get",dataType:"json"}).then(function(t){o(".pagination li").not(o(".pagination li").first()).not(o(".pagination li").last()).remove();for(var a=Math.ceil(t["count(*)"]/7),i=0;i<a;i++){if(0==i)var n='<li class="active"><a href="#">'+(i+1)+'<span class="sr-only">(current)</span></a></li>';else n='<li><a href="#">'+(i+1)+'<span class="sr-only">(current)</span></a></li>';o(n).insertBefore(o(".pagination li:last-of-type"))}o(".pagination li").not(o(".pagination li").first()).not(o(".pagination li").last()).on("click",function(){o(this).hasClass("active")||(l(s=o(this).index()-1),o(this).addClass("active").siblings().removeClass("active"),1==o(this).index()?(o(this).prev().addClass("disabled"),o(this).parent().children().last().removeClass("disabled")):(o(this).parent().children().first().removeClass("disabled"),o(this).index()==o(this).parent().children().length-2?o(this).next().addClass("disabled"):o(this).parent().children().last().removeClass("disabled")))})})}function l(n){o.ajax({url:"http://101.200.60.236:9090/job/job",type:"get",dataType:"json",data:{index:n}}).then(function(t){o("#tab").html("");for(var a=0;a<t.length;a++){if(e<=2)var i='<tr data-info="'+t[a].j_id+'"><td><input type="checkbox"/></td><td>'+t[a].j_position+"</td><td>"+t[a].j_class+"</td><td>"+t[a].j_address+"</td><td>"+t[a].j_num+"</td><td>"+t[a].j_time+'</td><td><a href="#" class="active">删除</a></td></tr>';else i='<tr data-info="'+t[a].j_id+'"><td><input type="checkbox"/></td><td>'+t[a].j_position+"</td><td>"+t[a].j_class+"</td><td>"+t[a].j_address+"</td><td>"+t[a].j_num+"</td><td>"+t[a].j_time+'</td><td><a href="#" class="disabled">删除</a></td></tr>';o("#tab").append(i)}console.log(o("#tab tr td a.active")),o("#tab tr td a.active").on("click",function(){o.ajax({url:"http://101.200.60.236:9090/job/del",type:"post",dataType:"json",data:{id:o(this).parents("tr").data("info")}}).then(function(t){o(this).parents("tr").remove(),d(),l(n)})})})}d(),l(0),o("table thead tr th input").on("click",function(){o("#tab input").prop("checked",o(this).prop("checked"))}),o(".pagination li").first().on("click",function(){if(!o(this).hasClass("disabled")){o(".pagination li").last().removeClass("disabled");var t=o(".pagination li.active").index();o(".pagination li").eq(t).removeClass("active"),o(".pagination li").eq(t-1).addClass("active"),2==t&&o(this).addClass("disabled"),l(--s)}}),o(".pagination li").last().on("click",function(){if(!o(this).hasClass("disabled")){o(".pagination li").first().removeClass("disabled");var t=o(".pagination li.active").index();o(".pagination li").eq(t).removeClass("active"),o(".pagination li").eq(t+1).addClass("active"),t==o(".pagination li").length-3&&o(this).addClass("disabled"),l(++s)}})})})});